<div class="mx-6 my-2">
  <p-card>
    <ng-template pTemplate="title">
      <div class="flex flex-col items-center justify-between sm:flex-row">
        <h5 class="m-0">{{'users.user_list' | translate}}</h5>
        <div class="flex items-center">
          <p-button [label]="'users.add_user' | translate" icon="pi pi-plus" class="mr-2" (onClick)="openNew()" />
          <p-iconfield>
            <p-inputicon styleClass="pi pi-search" />
            <input pInputText type="text" (input)="dt.filterGlobal($any($event.target).value, 'contains')" [placeholder]="('common.search' | translate)" />
          </p-iconfield>
        </div>
      </div>
    </ng-template>
    <p-table #dt
             [columns]="cols"
             [globalFilterFields]="['name', 'country.name', 'representative.name', 'status']"
             [paginator]="true"
             [rowHover]="true"
             [rows]="10"
             [showCurrentPageReport]="true"
             [value]="users"
             [currentPageReportTemplate]="'common.current_page_report_template' | translate"
             dataKey="id"
             responsiveLayout="stack">
      <ng-template #header>
        <tr>
          <th pSortableColumn="id">Id <p-sortIcon field="id" /></th>
          <th pSortableColumn="lastName">{{'users.last_name' | translate}} <p-sortIcon field="lastName" /></th>
          <th pSortableColumn="firstName">{{'users.first_name' | translate}} <p-sortIcon field="firstName" /></th>
          <th pSortableColumn="email">{{'common.email' | translate}} <p-sortIcon field="email" /></th>
          <th pSortableColumn="role">{{'users.role' | translate}} <p-sortIcon field="role" /></th>
          <th pSortableColumn="isActive">{{'users.status' | translate}} <p-sortIcon field="isActive" /></th>
          <th class="w-32"></th>
        </tr>
      </ng-template>
      <ng-template #body let-user>
        <tr>
          <td>{{ user.id }}</td>
          <td>{{ user.lastName }}</td>
          <td>{{ user.firstName }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.role }}</td>
          <td>
            <p-tag [value]="user.isActive ? ('users.activated' | translate) : ('users.not_activated' | translate)" [severity]="user.isActive ? 'success' : 'danger'" />
          </td>
          <td class="w-32">
            <ng-container *ngIf="user.id > 1">
              <p-button icon="pi pi-pencil" class="mr-2" [rounded]="true" [outlined]="true" (click)="editUser(user)" />
              <p-button icon="pi pi-trash" severity="danger" [rounded]="true" [outlined]="true" (click)="deleteUser(user)" />
            </ng-container>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
</div>

<p-confirmDialog [style]="{ width: '450px' }" />

